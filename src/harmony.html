<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Licensed under the MIT license: -->
<!-- http://www.opensource.org/licenses/mit-license.php -->
<!-- Copyright (c) 2010 Mr.doob, rhyolight, bebraw -->
<html lang="en">
    <head>
        <title>Harmony</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
        <link rel="stylesheet" type="text/css" href="css/ui-darkness/jquery-ui-1.8.custom.css" />
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <link rel="stylesheet" type="text/css" href="css/colorpicker.css">
        <script type="text/javascript" src="js/lib/jquery.js"></script>
        <script type="text/javascript" src="js/lib/jquery-ui.js"></script>
        <script type="text/javascript" src="js/lib/jquery-keycodes.js"></script>
        <script type="text/javascript" src="js/lib/jquery-mousecapture.js"></script>
        <script type="text/javascript" src="js/lib/colorpicker.js"></script>
        <script type="text/javascript" src="js/lib/shortcut.js"></script>
        <script type="text/javascript" src="js/lib/base64.js"></script>
        <script type="text/javascript" src="js/lib/canvas2image.js"></script>

        <script type="text/javascript" src="js/panels/brushes.js"></script>
        <script type="text/javascript" src="js/panels/canvas.js"></script>
        <script type="text/javascript" src="js/panels/menu.js"></script>
        <script type="text/javascript" src="js/panels/modifiers.js"></script>
        <script type="text/javascript" src="js/panels/palette.js"></script>
        <script type="text/javascript" src="js/panels/playback.js"></script>

        <script type="text/javascript" src="js/brushes/sketchy.js"></script>
        <script type="text/javascript" src="js/brushes/shaded.js"></script>
        <script type="text/javascript" src="js/brushes/chrome.js"></script>
        <script type="text/javascript" src="js/brushes/fur.js"></script>
        <script type="text/javascript" src="js/brushes/longfur.js"></script>
        <script type="text/javascript" src="js/brushes/web.js"></script>
        <script type="text/javascript" src="js/brushes/simple.js"></script>
        <script type="text/javascript" src="js/brushes/square.js"></script>
        <script type="text/javascript" src="js/brushes/ribbon.js"></script>
        <script type="text/javascript" src="js/brushes/circles.js"></script>
        <script type="text/javascript" src="js/brushes/squares.js"></script>
        <script type="text/javascript" src="js/brushes/grid.js"></script>
        <script type="text/javascript" src="js/brushes/stringy.js"></script>
        <script type="text/javascript" src="js/brushes/curvy.js"></script>
        <script type="text/javascript" src="js/brushes/eraser.js"></script>

        <script type="text/javascript" src="js/constraints/horizontal.js"></script>
        <script type="text/javascript" src="js/constraints/perspective.js"></script>
        <script type="text/javascript" src="js/constraints/vertical.js"></script>

        <script type="text/javascript" src="js/modifiers/horizontalmirror.js"></script>
        <script type="text/javascript" src="js/modifiers/radialmirror.js"></script>
        <script type="text/javascript" src="js/modifiers/verticalmirror.js"></script>

<script type="text/javascript" src="js/brushes/sketchy.js"></script>

        <script type="text/javascript">
        var BRUSHES = ["sketchy", "shaded", "chrome", "fur", "longfur", "web",
            "simple", "squares", "ribbon", "circles", "grid", "stringy",
            "curvy", "eraser"];
        var CONSTRAINTS = ["horizontal", "perspective", "vertical"];
        var MODIFIERS = ["horizontalmirror", "verticalmirror", "radialmirror"];
        var PANELS = ["brushes", "canvas", "modifiers", "palette", "playback"];

        $(function() {
            var $tab_title_input = $('#tabName');
            var tabCounter = 2;
            
            // tabs init with a custom tab template and an "add" callback filling in the content
            var $tabs = $('#pages').tabs({
                    tabTemplate: '<li><span class="ui-icon ui-icon-wrench modifyPage">Modify Page</span><a href="#{href}">#{label}</a><span class="ui-icon ui-icon-close removePage">Remove Page</span></li>',
                    //add: function(event, ui) {
                        //var tab_content = $tab_content_input.val() || 'Tab '+tab_counter+' content.';
                        //$(ui.panel).append('<p>'+tab_content+'</p>');
                    //}
            });

            // modal dialog init: custom buttons and a "close" callback reseting the form inside
            var $newTabDialog = $('#newTabDialog').dialog({
                autoOpen: false,
                modal: true,
                buttons: {
                        'New': function() {
                                newTab();
                                $(this).dialog('close');
                        },
                        'Cancel': function() {
                                $(this).dialog('close');
                        }
                },
                open: function() {
                        $tab_title_input.focus();
                },
                close: function() {
                        $form[0].reset();
                }
            });

            // addTab form: calls addTab function on submit and closes the dialog
            var $form = $('form', $newTabDialog).submit(function() {
                    newTab();
                    $newTabDialog.dialog('close');
                    return false;
            });

            // actual addTab function: adds new tab using the title input from the form above
            function newTab() {
                    var tab_title = $tab_title_input.val() || 'Tab ' + tabCounter;
                    $tabs.tabs('add', '#pages-' + tabCounter, tab_title);
                    tabCounter++;
            }

            $('#addNew').click(function() {
                $newTabDialog.dialog('open');
            });

            $('#about').click(function() {
                $('#aboutDialog').dialog('open');
            });

            $("#aboutDialog").dialog({
                height: 140, modal: true, autoOpen: false
            });

            var index = null;
            $('.removePage').live('click', function() {
                index = $('li',$tabs).index($(this).parent());

                $('#deleteConfirmDialog').dialog('open');
            });

            $("#deleteConfirmDialog").dialog({
                autoOpen: false,
                resizable: false,
                height:150,
                modal: true,
                buttons: {
                    'Delete page': function() {
                        $tabs.tabs('remove', index);
                        $(this).dialog('close');
                    },
                    Cancel: function() {
                        $(this).dialog('close');
                    }
                }
            });

        });
        </script>
    </head>
    <body>
        <div id="header" style="height:2em">
            <div id="pods">
                <span class="ui-icon ui-icon-plusthick" id="addNew">New</span>
            </div>
            
            <span class="ui-icon ui-icon-help" id="about">About</span>
        </div>
        <div id="pages">
            <ul>
                <li>
                    <span class="ui-icon ui-icon-wrench modifyPage">Modify Page</span>
                    <a href="#page1">Page</a>
                    <span class="ui-icon ui-icon-close removePage">Remove Page</span>
                </li>
            </ul>
            <div id="page1"></div>
        </div>

        <div id="newTabDialog" title="New Sketch">
            <form>
                <fieldset class="ui-helper-reset">
                    <label for="tabName">Name</label>
                    <input type="text" name="tabName" id="tabName" value="" class="ui-widget-content ui-corner-all" />
                </fieldset>
            </form>
	</div>

        <div id="aboutDialog" title="About">
            <p>Harmony v. 0.3</p>
            <p>
                <a href="http://mrdoob.com/blog/post/689" target="_blank">The original system</a>
            </p>
            <p>
                <a href="http://github.com/bebraw/Harmony-Brushes" target="_blank">Source</a>
            </p>
        </div>

        <div id="deleteConfirmDialog" title="Delete page?">
            <p>
                <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>
                    The page will be deleted permanently and cannot be recovered. Are you sure?
            </p>
        </div>


        <script type="text/javascript" src="js/utils.js"></script>
        <script type="text/javascript" src="js/constraints.js"></script>
        <script type="text/javascript" src="js/stroke.js"></script>
        <script type="text/javascript" src="js/painter.js"></script>
        <script type="text/javascript" src="js/harmony.js"></script>    
    </body>
</html>
